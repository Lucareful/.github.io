---
title: MySQL数据库引擎和数据类型
categories: 
- SQL知识
tags: 
- SQL概念
---

## **数据库引擎介绍**

### 前言

- 1、存储引擎其实就是对于数据库文件的一种存取机制，如何实现存储数据，如何为存储的数据建立索引以及如何更新，查询数据等技术实现的方法。
- 2、MySQL中的数据用各种不同的技术存储在文件（或内存）中，这些技术中的每一种技术都使用不同的存储机制，索引技巧，锁定水平并且最终提供广泛的不同功能和能力。在MySQL中将这些不同的技术及配套的相关功能称为存储引擎。
- 3、根据需求可以在表中设置不同的存储引擎。

### 查看mysql中的引擎

![查看引擎](https://raw.githubusercontent.com/Lucareful/ImgRepo/master/img/hexo_img/image-20200605131656597.png)

### MySQL中常用的几种存储引擎

### 1．`MyISAM`存储引擎

- 存放的位置 
  - MySQL如果使用`MyISAM`存储引擎，数据库文件类型就包括`.frm`、`.MYD`、`.MYI`，默认存放位置是`C:\Documentsand Settings\All Users\Application Data\MySQL\MySQL Server 5.1\data`

- 存放的方式 
  - `MyISAM` 这种存储引擎不支持事务，不支持行级锁，只支持并发插入的表锁，主要用于高负载的select。

- 索引的方式
  -  `MyISAM`也是使用B+tree索引但是和`Innodb`的在具体实现上有些不同。

该引擎基于`ISAM`数据库引擎，除了提供`ISAM`里所没有的索引和字段管理等大量功能，`MyISAM`还使用一种表格锁定的机制来优化多个并发的读写操作，但是需要经常运行OPTIMIZE TABLE命令，来恢复被更新机制所浪费的空间，否则碎片也会随之增加，最终影响数据访问性能。`MyISAM`还有一些有用的扩展，例如用来修复数据库文件的`MyISAMChk`工具和用来恢复浪费空间的 `MyISAMPack`工具。`MyISAM`强调了快速读取操作，主要用于高负载的select，这可能也是MySQL深受Web开发的主要原因：在Web开发中进行的大量数据操作都是读取操作，所以大多数虚拟主机提供商和Internet平台提供商（Internet Presence Provider, `IPP`）只允许使用`MyISAM`格式。

- `MyISAM`类型的表支持三种不同的存储结构：静态型、动态型、压缩型。

- 静态型：指定义的表列的大小是固定（即不含有：`xblob`、`xtext`、`varchar`等长度可变的数据类型），这样MySQL就会自动使用静态`MyISAM`格式。使用静态格式的表的性能比较高，因为在维护和访问以预定格式存储数据时需要的开销很低；但这种高性能是以空间为代价换来的，因为在定义的时候是固定的，所以不管列中的值有多大，都会以最大值为准，占据了整个空间。
- 动态型：如果列（即使只有一列）定义为动态的（`xblob`, `xtext`, `varchar`等数据类型），这时`MyISAM`就自动使用动态型，虽然动态型的表占用了比静态型表较少的空间，但带来了性能的降低，因为如果某个字段的内容发生改变则其位置很可能需要移动，这样就会导致碎片的产生，随着数据变化的增多，碎片也随之增加，数据访问性能会随之降低。
  对于因碎片增加而降低数据访问性这个问题，有两种解决办法：
  - a、尽可能使用静态数据类型；
  - b、经常使用`optimize table table_name`语句整理表的碎片，恢复由于表数据的更新和删除导致的空间丢失。如果存储引擎不支持` optimize table table_name`则可以转储并 重新加载数据，这样也可以减少碎片；
- 压缩型：如果在数据库中创建在整个生命周期内只读的表，则应该使用`MyISAM`的压缩型表来减少空间的占用。

> 优缺点：`MyISAM`的优势在于占用空间小，处理速度快。缺点是不支持事务的完整性和并发性。

### 2．`innoDB`存储引擎

- 存储位置
  - MySQL如果使用`InnoDB`存储引擎，数据库文件类型就包括`.frm`、`ibdata1`、`.ibd`，存放位置有两个，`.frm`文件默认存放位置是`C:\Documents and Settings\All Users\ApplicationData\MySQL\MySQL Server 5.1\data`，`ibdata1`、`.ibd`文件默认存放位置是MySQL安装目录下的data文件夹。
- `innodb`存储引擎的mysql表提供了事务，回滚以及系统崩溃修复能力和多版本迸发控制的事务的安全。
- `innodb`支持自增长列（auto_increment）,自增长列的值不能为空，如果在使用的时候为空的话怎会进行自动存现有的值开始增值，如果有但是比现在的还大，则就保存这个值。

- `innodb`存储引擎支持外键（foreign key） ,外键所在的表称为子表而所依赖的表称为父表。

- `innodb`存储引擎最重要的是支持事务，以及事务相关联功能。

- `innodb`存储引擎支持`mvcc`的行级锁。

- `innodb`存储引擎索引使用的是B+Tree

> 优缺点：`InnoDB`的优势在于提供了良好的事务处理、崩溃修复能力和并发控制。缺点是读写效率较差，占用的数据空间相对较大。

<!--more-->

### 3．`MEMORY`存储引擎

- `memory`存储引擎相比前面的一些存储引擎，有点不一样，其使用存储在内从中的数据来创建表，而且所有的数据也都存储在内存中。
- 每个基于memory存储引擎的表实际对应一个磁盘文件，该文件的文件名和表名是相同的，类型为`.frm`。该文件只存储表的结构，而其数据文件，都是存储在内存中，这样有利于对数据的快速处理，提高整个表的处理能力。

- `memory`存储引擎默认使用哈希（HASH）索引，其速度比使用`B-+ Tree`型要快，如果读者希望使用B树型，则在创建的时候可以引用。

- `memory`存储引擎文件数据都存储在内存中，如果`mysqld`进程发生异常，重启或关闭机器这些数据都会消失。所以`memory`存储引擎中的表的生命周期很短，一般只使用一次。

### 4．`ARCHIVE`存储引擎

- 该存储引擎非常适合存储大量独立的、作为历史记录的数据。
- 区别于`InnoDB`和`MyISAM`这两种引擎，ARCHIVE提供了压缩功能，拥有高效的插入速度，但是这种引擎不支持索引，所以查询性能较差一些。

## 四种存储引擎比较

- `InnoDB`：支持事务处理，支持外键，支持崩溃修复能力和并发控制。如果需要对事务的完整性要求比较高（比如银行），要求实现并发控制（比如售票），那选择`InnoDB`有很大的优势。如果需要频繁的更新、删除操作的数据库，也可以选择`InnoDB`，因为支持事务的提交（commit）和回滚（rollback）。
- `MyISAM`：插入数据快，空间和内存使用比较低。如果表主要是用于插入新记录和读出记录，那么选择`MyISAM`能实现处理高效率。如果应用的完整性、并发性要求比 较低，也可以使用。如果数据表主要用来插入和查询记录，则`MyISAM`引擎能提供较高的处理效率
- `MEMORY`：所有的数据都在内存中，数据的处理速度快，但是安全性不高。如果需要很快的读写速度，对数据的安全性要求较低，可以选择`MEMOEY`。它对表的大小有要求，不能建立太大的表。所以，这类数据库只使用在相对较小的数据库表。如果只是临时存放数据，数据量不大，并且不需要较高的数据安全性，可以选择将数据保存在内存中的`Memory`引擎，MySQL中使用该引擎作为临时表，存放查询的中间结果

- 如果只有`INSERT`和`SELECT`操作，可以选择`Archive`，`Archive`支持高并发的插入操作，但是本身不是事务安全的。

- `Archive`非常适合存储归档数据，如记录日志信息可以使用`Archiv`

> 注意，同一个数据库也可以使用多种存储引擎的表。如果一个表要求比较高的事务处理，可以选择`InnoDB`。这个数据库中可以将查询要求比较高的表选择`MyISAM`存储。如果该数据库需要一个用于查询的临时表，可以选择MEMORY存储引擎。

## 数据类型

### 数值类型

MySQL支持所有标准SQL数值数据类型。

这些类型包括严格数值数据类型(INTEGER、SMALLINT、DECIMAL和NUMERIC)，以及近似数值数据类型(FLOAT、REAL和DOUBLE PRECISION)。

关键字INT是INTEGER的同义词，关键字DEC是DECIMAL的同义词。

BIT数据类型保存位字段值，并且支持MyISAM、MEMORY、InnoDB和BDB表。

作为SQL标准的扩展，MySQL也支持整数类型TINYINT、MEDIUMINT和BIGINT。下面的表显示了需要的每个整数类型的存储和范围。

| 类型         | 大小                                     | 范围（有符号）                                               | 范围（无符号）                                               | 用途            |
| :----------- | :--------------------------------------- | :----------------------------------------------------------- | :----------------------------------------------------------- | :-------------- |
| TINYINT      | 1 byte                                   | (-128，127)                                                  | (0，255)                                                     | 小整数值        |
| SMALLINT     | 2 bytes                                  | (-32 768，32 767)                                            | (0，65 535)                                                  | 大整数值        |
| MEDIUMINT    | 3 bytes                                  | (-8 388 608，8 388 607)                                      | (0，16 777 215)                                              | 大整数值        |
| INT或INTEGER | 4 bytes                                  | (-2 147 483 648，2 147 483 647)                              | (0，4 294 967 295)                                           | 大整数值        |
| BIGINT       | 8 bytes                                  | (-9,223,372,036,854,775,808，9 223 372 036 854 775 807)      | (0，18 446 744 073 709 551 615)                              | 极大整数值      |
| FLOAT        | 4 bytes                                  | (-3.402 823 466 E+38，-1.175 494 351 E-38)，0，(1.175 494 351 E-38，3.402 823 466 351 E+38) | 0，(1.175 494 351 E-38，3.402 823 466 E+38)                  | 单精度 浮点数值 |
| DOUBLE       | 8 bytes                                  | (-1.797 693 134 862 315 7 E+308，-2.225 073 858 507 201 4 E-308)，0，(2.225 073 858 507 201 4 E-308，1.797 693 134 862 315 7 E+308) | 0，(2.225 073 858 507 201 4 E-308，1.797 693 134 862 315 7 E+308) | 双精度 浮点数值 |
| DECIMAL      | 对DECIMAL(M,D) ，如果M>D，为M+2否则为D+2 | 依赖于M和D的值                                               | 依赖于M和D的值                                               | 小数值          |

------

### 日期和时间类型

表示时间值的日期和时间类型为DATETIME、DATE、TIMESTAMP、TIME和YEAR。

每个时间类型有一个有效值范围和一个"零"值，当指定不合法的MySQL不能表示的值时使用"零"值。

TIMESTAMP类型有专有的自动更新特性，将在后面描述。

| 类型      | 大小 ( bytes) | 范围                                                         | 格式                | 用途                     |
| :-------- | :------------ | :----------------------------------------------------------- | :------------------ | :----------------------- |
| DATE      | 3             | 1000-01-01/9999-12-31                                        | YYYY-MM-DD          | 日期值                   |
| TIME      | 3             | '-838:59:59'/'838:59:59'                                     | HH:MM:SS            | 时间值或持续时间         |
| YEAR      | 1             | 1901/2155                                                    | YYYY                | 年份值                   |
| DATETIME  | 8             | 1000-01-01 00:00:00/9999-12-31 23:59:59                      | YYYY-MM-DD HH:MM:SS | 混合日期和时间值         |
| TIMESTAMP | 4             | 1970-01-01 00:00:00/2038结束时间是第 **2147483647** 秒，北京时间 **2038-1-19 11:14:07**，格林尼治时间 2038年1月19日 凌晨 03:14:07 | YYYYMMDD HHMMSS     | 混合日期和时间值，时间戳 |

------

### 字符串类型

字符串类型指CHAR、VARCHAR、BINARY、VARBINARY、BLOB、TEXT、ENUM和SET。该节描述了这些类型如何工作以及如何在查询中使用这些类型。

| 类型       | 大小                  | 用途                            |
| :--------- | :-------------------- | :------------------------------ |
| CHAR       | 0-255 bytes           | 定长字符串                      |
| VARCHAR    | 0-65535 bytes         | 变长字符串                      |
| TINYBLOB   | 0-255 bytes           | 不超过 255 个字符的二进制字符串 |
| TINYTEXT   | 0-255 bytes           | 短文本字符串                    |
| BLOB       | 0-65 535 bytes        | 二进制形式的长文本数据          |
| TEXT       | 0-65 535 bytes        | 长文本数据                      |
| MEDIUMBLOB | 0-16 777 215 bytes    | 二进制形式的中等长度文本数据    |
| MEDIUMTEXT | 0-16 777 215 bytes    | 中等长度文本数据                |
| LONGBLOB   | 0-4 294 967 295 bytes | 二进制形式的极大文本数据        |
| LONGTEXT   | 0-4 294 967 295 bytes | 极大文本数据                    |

**注意**：char(n) 和 varchar(n) 中括号中 n 代表字符的个数，并不代表字节个数，比如 CHAR(30) 就可以存储 30 个字符。

CHAR 和 VARCHAR 类型类似，但它们保存和检索的方式不同。它们的最大长度和是否尾部空格被保留等方面也不同。在存储或检索过程中不进行大小写转换。

BINARY 和 VARBINARY 类似于 CHAR 和 VARCHAR，不同的是它们包含二进制字符串而不要非二进制字符串。也就是说，它们包含字节字符串而不是字符字符串。这说明它们没有字符集，并且排序和比较基于列值字节的数值值。

BLOB 是一个二进制大对象，可以容纳可变数量的数据。有 4 种 BLOB 类型：TINYBLOB、BLOB、MEDIUMBLOB 和 LONGBLOB。它们区别在于可容纳存储范围不同。

有 4 种 TEXT 类型：TINYTEXT、TEXT、MEDIUMTEXT 和 LONGTEXT。对应的这 4 种 BLOB 类型，可存储的最大长度不同，可根据实际情况选择。